## Python Geoespacial

Esta lección está basada en gran medida en el material de [Introduction to Geospatial Raster and Vector Data with Python](https://carpentries-incubator.github.io/geospatial-python/index.html) de The Carpentries, disponible bajo licencia [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/), al igual que nuestro material.

### Objetivos

Desarrollar habilidades básicas en programación GIS para trabajar con datos públicos abiertos sobre riesgo climático en Argentina y el mundo. Aprender sobre tipos de datos geoespaciales, proyecciones, operaciones espaciales, análisis básico y visualización.

### ¿Qué es GIS?

GIS es software que permite interactuar con datos geoespaciales. Herramientas comunes incluyen ArcGIS, PostGIS, QGIS, GDAL, Earth Engine, R y Python.

### Tipos de Software GIS

**Interfaz Gráfica de Usuario (GUI)**

Ventajas: No requiere aprender programación. Mapeo y visualización más intuitivos y flexibles.

Desventajas: No es reproducible. No escala ni automatiza bien. Difícil de personalizar.

Ejemplos: ArcGIS, QGIS.

**Interfaz de Línea de Comandos (CLI) / Programación**

Ventajas: Muy reproducible. Flexible, escalable y automatizable. Fácil de integrar con otras herramientas.

Desventajas: Requiere aprender un lenguaje. Mapeo y visualización menos intuitivos. Curva de aprendizaje inicial.

### ¿Por qué Python?

Python es ampliamente usado con un ecosistema rico de bibliotecas. Es flexible, poderoso y relativamente fácil de aprender. Está bien integrado con otras herramientas, es gratuito, de código abierto, y tiene una comunidad activa con documentación sólida.

### ¿Por qué Google Colab?

No requiere configurar un ambiente local. Es flexible e independiente de los recursos de tu computadora. Permite escalar recursos pagando si es necesario, aunque no será necesario en este curso.

Para otros contextos, se recomienda instalar localmente usando UV y un IDE como VS Code.

### Computación en la Nube

La nube significa simplemente la computadora de alguien más: servidores a los que tu dispositivo se conecta por internet.

**Ventajas**

Poderosa: puedes escalar recursos flexiblemente según tus necesidades. No requiere configurar servidores locales ni instalar programas localmente. Infraestructura distribuida resiliente ante fallas.

**Desventajas**

Requiere conexión a internet. Curva de aprendizaje inicial. Puede ser costosa con uso intensivo.

Las herramientas nativas de la nube que usaremos no son más difíciles que las herramientas tradicionales y ofrecen muchas ventajas. La nube es simplemente uno de los lugares donde la gente computa hoy.

### Sistemas de Referencia de Coordenadas (CRS)

Los CRS son la base de cómo se representan los datos espaciales. Todos los datos espaciales tienen un CRS porque todos están técnicamente distorsionados. El mundo es aproximadamente esférico, no plano. Para representar datos esféricos tridimensionales en dos dimensiones, debemos distorsionarlos.

![Metáfora de la naranja [@carpentries_geospatial_python]](../../public/python-geoespacial/orange-peel-earth.jpg)

Hay diferentes formas de hacer esto según el uso previsto de los datos. La metáfora de la naranja: si pelas una naranja y aplanas la cáscara, debes distorsionarla de diferentes maneras.

**Reglas fundamentales**

Siempre necesitas un CRS para tus datos. Siempre debes saber cuál es el CRS de tus datos. Debes elegirlo apropiadamente para el contexto: a veces querrás el CRS local, a veces Web Mercator, a veces WGS 84.

Cuando hay problemas en análisis geoespacial, a menudo están relacionados con el CRS. Al resolver problemas, una de las primeras cosas que debes verificar es si es un problema de CRS.

## Datos vectoriales

Los datos vectoriales están compuestos de ubicaciones geométricas discretas: puntos, líneas o polígonos. Representan características del planeta y asignan atributos a esas cosas en formato tabular.

![Datos vectoriales [@carpentries_geospatial_python]](../../public/python-geoespacial/spatial_extent.png)

Obtienes una tabla con diferentes atributos como nombres o valores (población, temperatura, etc.) y luego una columna de geometría que indica la forma física de esa cosa en el espacio. Esta columna de geometría puede contener punto, línea, polígono o multipolígono.

![GeoDataframe [@carpentries_geospatial_python]](../../public/python-geoespacial/pandas_geopandas_relation.png)

```{python}
import geopandas as gpd
import matplotlib.pyplot as plt

partidos_path = "../../public/python-geoespacial/pba_partidos.geojson"

partidos = gpd.read_file(partidos_path)

partidos = partidos.to_crs("EPSG:5348") # Reproyectar al CRS POSGAR 2007 / Argentina 4
```

```{python}
partidos.head()
```

```{python}
partidos.plot()
```

### GeoPandas

GeoPandas es el módulo principal para datos vectoriales en Python, aunque hay otros.

GeoPandas permite operaciones espaciales y no espaciales:

**Operaciones no espaciales**

Filtrado por columnas: buscar columnas con cierto nombre o valor.

**Operaciones espaciales**

Filtrado espacial: buscar columnas dentro de cierta área, fuera de cierta área, etc.

Las operaciones espaciales pueden ser sofisticadas porque funcionan como constructos lógicos. Puedes decir "dame todo lo que está dentro de esto O toca esto O no toca esto O toca esto PERO no se superpone completamente O se superpone completamente PERO no solo toca el exterior".

Esta es un área sutil que requiere pensamiento cuidadoso sobre las diferencias entre operaciones. Por ejemplo, intersección y clip no son lo mismo.

## Datos raster

Los datos raster son datos de píxeles. Representan el espacio dividiéndolo en celdas de cuadrícula consistentes. Cada celda tiene un valor.

![Datos raster [@carpentries_geospatial_python]](../../public/python-geoespacial/raster_concept.png)

Las celdas de la cuadrícula tienen una resolución consistente. Los valores pueden ser continuos o categóricos.

Los raster se usan para representar muchos tipos diferentes de datos. En este taller representamos DEM (Modelo Digital de Elevación) y clases de cobertura del suelo: DEM siendo continuo, cobertura del suelo siendo codificada categóricamente.

## Análisis espacial

## Operaciones Espaciales Básicas

### Reproyecciones

### Operaciones de Recorte

### Superposiciones Espaciales

### Estadísticas Zonales

### Agregaciones Espaciales Básicas

### Extracción de Raster

## Recursos Adicionales y Aprendizaje Avanzado

Rey, S., Arribas-Bel, D., & Wolf, L. (2023). Geographic Data Science with
Python. Disponible en: https://geographicdata.science/book/intro.html

Dorman, M. (2023). Geocomputation with Python. Disponible en:
https://py.geocompx.org/

Material seleccionado de PyGIS (https://pygis.io)